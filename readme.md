# MoviesDB

## About

This is a simple website I've created for a test at work. It's a simple movie database, with it's own ratings, and which allows you to create a user and mark them as favorites.

It is written in PHP 7.1 using Laravel 5.6, and can run on both Nginx and Apache, using Mysql to store data. Authentication is generated by `php artisan make:auth`, not developed from scratch for this application.

## Setting it up

#### General requirements:

* PHP 7.1
* Composer

### Easy Way

#### Additional Requirements:

* Vagrant
* Some vagrant driver (for example Virtualbox)

#### Steps:

* Clone the repository and open it's directory.
* Copy the `.env.example` file to `.env`.
* Run `composer install` to install dependencies.
* Run `./vendor/bin/homestead make` (`./vendor/bin/homestead.bat make` on Windows) to generate the homestead files.
* Adjust `homestead.yaml` (generated in project root folder) as necessary.
* Run `vagrant up` to start the box.
* Access the box using `vagrant ssh`, and use `php artisan key:generate` to generate an application key, `php artisan migrate` to create DB tables, and `php artisan db:seed` to seed the test data.
* Access it using the ip specified in `homestead.yaml`.

### Less Easy Way

#### Additional Requirements:

* Mysql 5.7
* Nginx OR apache

#### Steps:

* Clone the repository and open it's directory.
* Create a database for the website to use.
* Copy the `.env.example` file to `.env`. Add mysql credentials and database info to the relevant variables.
* Run `composer install` to install dependencies.
* Use `php artisan key:generate` to generate an application key, `php artisan migrate` to create DB tables, and `php artisan db:seed` to seed the test data.
* Configure your webserver as necessary, to serve the `public/` directory. For apache, enable mod_rewrite and per directory configs. For Nginx, see "Configuring Nginx" [here](https://www.digitalocean.com/community/tutorials/how-to-deploy-a-laravel-application-with-nginx-on-ubuntu-16-04#step-5-%E2%80%94-configuring-nginx).
* Access it.

## Structure

* app/ - The location of all the application code, and where the DB models are located.
* app/Http/Controllers - The location of the application controllers.
* routes/web.php - The file containing all the routes.
* database/migrations - The migrations building the database.
* database/seeds/JsonSeed.php - File handling the seeding of the database with test data.
* public/ - Contains the files accessed by the browser.
* resources/views/ - Contains the views rendered by the application and shown in the browser.
* resources/assets/ - Contains all raw assets, which are either compiled, transpiled, or copied to the public directory.

## Changing the Application

### Adding new Features

To add any new features you simply have to add the relevant files, which can also utilize the full framework. For new pages, you can simply create a new controller, and add a route leading to it. Add a new view if necessary.  
For other kind of features, such as automated jobs, api endpoints, etc. the process is similarly simple. Any developer with experience with Laravel will be able to do it easily, other PHP developers can easily learn it.

### Changing the Database Layer

Database drivers in Laravel are by default plug and play. If you can find a driver for the new database, you can just replace the old one with it (though you will need to make a script to transfer data).  
HOWEVER, in this specific application I do need to use some raw SQL, which means that when changing the database you will need to check that `"/database/migrations/2018_03_17_130104_create_movies_view.php"` still functions, and that the quering of that view is functional.

### Testing

Due to time constrains I did not have the opportunity to write the tests, however:  
* A lot of the logic of the application is in the models. You can easily seed the database, then write tests testing each each method for each model, and checking the return values and the content in the database. Several of the methods in the Models also interact with multiple models.
* You can also do i.e. a specific test against the add/remove favorite route, checking that it will reject unauthorized users, and similar.
* You can do tests against the authentication, login, registration, etc., however, since this is implemented in the framework itself you can reasonably assume it is not gonna break without warning from application changes, without breaking other things along with it.

Laravel uses Phpunit, and also has an interface to help write tests more efficiently ([Read more](https://laravel.com/docs/5.6/testing)).

## License

The Laravel framework and this application are licenced under an MIT licence. [MIT license](https://opensource.org/licenses/MIT).
